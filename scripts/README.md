# Pre-commit CI Check Script

åœ¨æäº¤ä»£ç å‰è¿è¡Œæ‰€æœ‰ GitHub Actions CI æ£€æŸ¥ï¼Œç¡®ä¿ä»£ç è´¨é‡ã€‚

## ä½¿ç”¨æ–¹æ³•

### æ–¹å¼ 1: ä½¿ç”¨ npm è„šæœ¬ (æ¨è)

```bash
npm run pre-commit
```

### æ–¹å¼ 2: ç›´æ¥è¿è¡Œè„šæœ¬

```bash
bash scripts/pre-commit-check.sh
```

### æ–¹å¼ 3: è·³è¿‡æµ‹è¯• (ä»…æ£€æŸ¥ç±»å‹å’Œç¼–è¯‘)

```bash
SKIP_TESTS=1 npm run pre-commit
```

## æ£€æŸ¥å†…å®¹

è„šæœ¬æŒ‰é¡ºåºæ‰§è¡Œä»¥ä¸‹æ£€æŸ¥ï¼š

1. âœ… **å®‰è£…ä¾èµ–** - `npm ci`
2. âœ… **ç”Ÿæˆ Motia ç±»å‹** - `npm run generate-types`
3. âœ… **TypeScript ç±»å‹æ£€æŸ¥** - `npx tsc --noEmit`
4. âœ… **ESLint æ£€æŸ¥** - `npm run lint`
5. âœ… **TypeScript ç¼–è¯‘** - `npm run build:ts`
6. âœ… **Jest æµ‹è¯•** - `npm run test -- --passWithNoTests` (å¯é€‰)

## è¾“å‡ºç¤ºä¾‹

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                              â•‘
â•‘  ğŸš€ Pre-commit CI Check                                                      â•‘
â•‘  Running all GitHub Actions checks locally                                   â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  1. Installing Dependencies (npm ci)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ“ Dependencies installed

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  2. Generating Motia Types
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ“ Motia types generated

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  3. TypeScript Type Check (tsc --noEmit)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ“ TypeScript type check passed

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  4. ESLint Check
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ“ ESLint passed (0 errors, 93 warnings)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  5. TypeScript Compilation (build:ts)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ“ TypeScript compilation successful

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  6. Jest Tests (Optional)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ“ Tests completed (91/160 passed)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Summary
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ“ All CI checks passed!

  Passed: 6
  Failed: 0

  Time taken: 45s

ğŸ‰ Safe to commit!
```

## é€€å‡ºä»£ç 

- **0**: æ‰€æœ‰æ£€æŸ¥é€šè¿‡ âœ…
- **1**: æœ‰æ£€æŸ¥å¤±è´¥ âŒ

## Git Hook é›†æˆ (å¯é€‰)

å¦‚æœä½ æƒ³åœ¨æ¯æ¬¡ commit å‰è‡ªåŠ¨è¿è¡Œæ£€æŸ¥ï¼Œå¯ä»¥å®‰è£… husky:

```bash
npm install -D husky
npx husky install
npx husky add .husky/pre-commit "npm run pre-commit"
```

## æ³¨æ„äº‹é¡¹

1. **æµ‹è¯•æ˜¯å¯é€‰çš„**: é»˜è®¤ä¼šè¿è¡Œæµ‹è¯•ï¼Œä½†å³ä½¿æµ‹è¯•å¤±è´¥ä¹Ÿä¸ä¼šé˜»æ­¢æäº¤ (å› ä¸ºæŸäº›é›†æˆæµ‹è¯•éœ€è¦æœåŠ¡å™¨è¿è¡Œ)
2. **è·³è¿‡æµ‹è¯•**: å¦‚æœåªæƒ³å¿«é€Ÿæ£€æŸ¥ç±»å‹å’Œç¼–è¯‘ï¼Œä½¿ç”¨ `SKIP_TESTS=1`
3. **è­¦å‘Šä¸é˜»æ­¢æäº¤**: ESLint çš„è­¦å‘Š (warnings) ä¸ä¼šå¯¼è‡´æ£€æŸ¥å¤±è´¥ï¼Œåªæœ‰é”™è¯¯ (errors) ä¼š

## æ•…éšœæ’æŸ¥

### é—®é¢˜: TypeScript ç¼–è¯‘å¤±è´¥

```bash
# æ¸…ç†å¹¶é‡æ–°å®‰è£…
npm run clean
npm install
npm run pre-commit
```

### é—®é¢˜: ç±»å‹æ£€æŸ¥é”™è¯¯

```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
npx tsc --noEmit
```

### é—®é¢˜: æµ‹è¯•è¶…æ—¶

```bash
# è·³è¿‡æµ‹è¯•
SKIP_TESTS=1 npm run pre-commit
```
